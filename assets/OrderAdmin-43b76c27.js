import{S as m}from"./sweetalert2.all-63bbc384.js";import{M as V,p as y}from"./modal-d0dc8bf1.js";import{_ as v,o as p,c as u,e,t as c,j as a,J as d,M as E,r as h,F as T,i as C,f}from"./index-122c6dcc.js";import"./component-functions-d4c70f62.js";const{VITE_URL:x,VITE_PATH:P}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"lina-vueapi",BASE_URL:"/Vue2022_deeplyprefect/",MODE:"production",DEV:!1,PROD:!0},U={props:["tempOrder"],data(){return{editModal:"",temp:{user:{}}}},methods:{openModal(){this.editModal.show()},closeModal(){this.editModal.hide()},editOrder(){const l=`${x}api/${P}/admin/order/${this.temp.id}`;this.$http.put(l,{data:this.temp}).then(()=>{m.fire({toast:!0,title:"編輯訂單成功！",icon:"success",timer:2e3,position:"top-end",showConfirmButton:!1}),this.$emit("getOrders"),this.closeModal()}).catch(t=>{m.fire({title:t.response.data.message,icon:"error"})})}},watch:{tempOrder(){this.temp={...this.tempOrder}}},mounted(){this.editModal=new V(this.$refs.editOrderModal)}},$={class:"modal",ref:"editOrderModal"},k={class:"modal-dialog modal-lg"},w={class:"modal-content"},L=e("div",{class:"modal-header"},[e("h2",{class:"modal-title fs-5"},"編輯訂單"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},A={class:"mb-4"},B=e("h3",{class:"fs-6 border-bottom pb-2 mb-3"},"收件人資訊",-1),I={class:"row g-3 mb-5"},R={class:"col-md-6"},S=e("label",{for:"receiverName",class:"form-label"},"姓名",-1),H={class:"col-md-6"},G=e("label",{for:"receiverTel",class:"form-label"},"電話",-1),N={class:"col-12"},j=e("label",{for:"receiverEmail",class:"form-label"},"Email",-1),F={class:"col-12"},J=e("label",{for:"address",class:"form-label"},"地址",-1),q={class:"col-12"},z=e("label",{for:"message",class:"form-label"},"留言",-1),K=e("h3",{class:"fs-6 border-bottom pb-2 mb-3"},"收件人資訊",-1),Q={class:"mb-3"},W=e("label",{for:"orderAmount",class:"form-label"},"訂單總金額",-1),X={class:"mb-3"},Y={class:"form-check"},Z=e("label",{class:"form-check-label",for:"is_enabled"},"是否付款",-1),ee={class:"modal-footer"},te=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function se(l,t,r,_,s,i){return p(),u("div",$,[e("div",k,[e("div",w,[L,e("div",D,[e("p",A,"訂單編號： "+c(s.temp.id),1),B,e("form",I,[e("div",R,[S,a(e("input",{type:"texet",class:"form-control",id:"receiverName","onUpdate:modelValue":t[0]||(t[0]=o=>s.temp.user.name=o)},null,512),[[d,s.temp.user.name]])]),e("div",H,[G,a(e("input",{type:"tel",class:"form-control",id:"receiverTel","onUpdate:modelValue":t[1]||(t[1]=o=>s.temp.user.tel=o)},null,512),[[d,s.temp.user.tel]])]),e("div",N,[j,a(e("input",{type:"email",class:"form-control",id:"receiverEmail","onUpdate:modelValue":t[2]||(t[2]=o=>s.temp.user.email=o)},null,512),[[d,s.temp.user.email]])]),e("div",F,[J,a(e("input",{type:"text",class:"form-control",id:"address","onUpdate:modelValue":t[3]||(t[3]=o=>s.temp.user.address=o)},null,512),[[d,s.temp.user.address]])]),e("div",q,[z,a(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"3","onUpdate:modelValue":t[4]||(t[4]=o=>s.temp.message=o)},null,512),[[d,s.temp.message]])])]),K,e("div",Q,[W,a(e("input",{type:"number",class:"form-control",id:"orderAmount","onUpdate:modelValue":t[5]||(t[5]=o=>s.temp.total=o)},null,512),[[d,s.temp.total]])]),e("div",X,[e("div",Y,[a(e("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=o=>s.temp.is_paid=o)},null,512),[[E,s.temp.is_paid]]),Z])])]),e("div",ee,[te,e("button",{type:"button",class:"btn btn-primary",onClick:t[7]||(t[7]=(...o)=>i.editOrder&&i.editOrder(...o))}," 編輯 ")])])])],512)}const oe=v(U,[["render",se]]),{VITE_URL:b,VITE_PATH:g}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"lina-vueapi",BASE_URL:"/Vue2022_deeplyprefect/",MODE:"production",DEV:!1,PROD:!0},le={components:{pagination:y,editModal:oe},data(){return{orderList:[],pages:{},tempOrder:{},currentPage:1}},methods:{getCurrentPage(l){this.currentPage=l,this.getOrders(this.currentPage)},getOrders(l=1){const t=`${b}api/${g}/admin/orders?page=${l}`;this.$http.get(t).then(r=>{this.orderList=r.data.orders,this.pages=r.data.pagination}).catch(r=>{m.fire({title:r.response.data.message,icon:"error"})})},deleteOrder(l){m.fire({title:`確認是否刪除 ${l.id} 訂單？`,showCancelButton:!0,confirmButtonText:"刪除",cancelButtonText:"取消"}).then(t=>{if(t.isConfirmed){const r=`${b}api/${g}/admin/order/${l.id}`;this.$http.delete(r).then(()=>{this.getOrders(),m.fire({toast:!0,title:"已刪除該筆訂單",icon:"success",timer:2e3,showConfirmButton:!1})}).catch(_=>{m.fire({title:_.reponse.data.message,icon:"error"})})}})},openModal(l){this.tempOrder={...l},this.$refs.editMsg.openModal()}},mounted(){this.getOrders()}},re={class:"container py-5"},ne={class:"row justify-content-center"},ie={class:"col-lg-10"},ae=e("h1",{class:"fs-5 mb-3"},"訂單管理",-1),de={class:"table"},ce=e("thead",null,[e("tr",null,[e("th",null,"訂單編號"),e("th",null,"收件人 Email"),e("th",null,"訂購日期"),e("th",null,"是否付款"),e("th")])],-1),me=["onClick"],pe=["onClick"];function ue(l,t,r,_,s,i){const o=h("pagination"),O=h("editModal");return p(),u("div",re,[e("div",ne,[e("div",ie,[ae,e("table",de,[ce,e("tbody",null,[(p(!0),u(T,null,C(s.orderList,n=>(p(),u("tr",{key:n.id},[e("td",null,c(n.id),1),e("td",null,c(n.user.email),1),e("td",null,c(new Date(n.create_at*1e3).toLocaleDateString())+" "+c(new Date(n.create_at*1e3).toLocaleTimeString()),1),e("td",null,c(n.is_paid?"是":"否"),1),e("td",null,[e("button",{type:"button",class:"btn btn-sm btn-primary",onClick:M=>i.openModal(n)}," 編輯 ",8,me),e("button",{type:"button",class:"btn btn-sm btn-outline-danger ms-1",onClick:M=>i.deleteOrder(n)}," 刪除 ",8,pe)])]))),128))])]),f(o,{class:"mt-2",pages:s.pages,onGetCurrentPage:i.getCurrentPage},null,8,["pages","onGetCurrentPage"])])]),f(O,{ref:"editMsg","temp-order":s.tempOrder,onGetOrders:i.getOrders},null,8,["temp-order","onGetOrders"])])}const ge=v(le,[["render",ue]]);export{ge as default};
